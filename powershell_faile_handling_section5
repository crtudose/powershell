# File handling / text files
# foreach($server in $serverlist)

Script referring to the class : Handling text files using powershell.
------------------------------------------
# This script is returning in an output text file the name of the server, OS, lastreboot time converted to human readable format

$servers=Get-Content C:\ps\MyFiles\ServerList.txt
Clear-Content C:\PS\MyFiles\output.txt
foreach($server in $servers)
{
 'The script is going to get executed in ' + $server +  'Server' | out-file C:\PS\MyFiles\output.txt -Append
  $serveroutput=Get-WmiObject -Class Win32_Operatingsystem -ComputerName $server | Select-Object @{'Name'='ServerName';'Expression'={$_.PSCOmputerName}},
 @{'Name'='Last Restart Time';'Expression'={$_.ConvertToDateTime($_.LastBootUpTime)}}
  $serveroutput.ServerName+','+ $serveroutput.'Last Restart Time' | out-file C:\PS\MyFiles\output.txt -Append
} 
$servers=Get-Content C:\ps\MyFiles\ServerList.txt

Clear-Content C:\PS\MyFiles\output.txt

Handling csv files
---------------
import-csv cmdlet creates table-like custom objects from the items in a comma separated csv file
for example, we input in file ServerList_CSV.csv file the below data
ServerName, IP
VM1, 192.168.225.11
VM2, 192.168.225.12
CENTRALSERVER,192,168.225.10

Convert data from CSV into structured manner
# Import-csv C:\ps\MyFiles\ServerList_CSV.csv
Send this data to a variable:
$servers=Import-csv C:\ps\MyFiles\ServerList_CSV.csv
foreach($server in $servers)
{
$servername=$server.ServerName
$ip=$server.IP
}
